<Page
    x:Class="ForzaTools.ForzaAnalyzer.Views.FileDetailsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:vm="using:ForzaTools.ForzaAnalyzer.ViewModels"
    mc:Ignorable="d">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*" MinWidth="250"/>
            <ColumnDefinition Width="2*"/>
        </Grid.ColumnDefinitions>

        <Border Grid.Column="0" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="0,0,1,0" Background="{ThemeResource LayerFillColorDefaultBrush}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <TextBlock Text="{x:Bind ViewModel.FileName, Mode=OneWay}" Margin="16" Style="{StaticResource SubtitleTextBlockStyle}"/>

                <TreeView Grid.Row="1" ItemsSource="{x:Bind ViewModel.Nodes, Mode=OneWay}" ItemInvoked="TreeView_ItemInvoked">
                    <TreeView.ItemTemplate>
                        <DataTemplate x:DataType="vm:ObjectNode">
                            <TreeViewItem ItemsSource="{x:Bind Children}">
                                <TextBlock Text="{x:Bind Title}"/>
                            </TreeViewItem>
                        </DataTemplate>
                    </TreeView.ItemTemplate>
                </TreeView>
            </Grid>
        </Border>

        <ScrollViewer Grid.Column="1" Padding="24">
            <StackPanel Spacing="16">
                <TextBlock Text="{x:Bind ViewModel.SelectedNode.Title, Mode=OneWay, FallbackValue='Select an item'}" 
                           Style="{StaticResource TitleTextBlockStyle}"/>

                <ItemsControl ItemsSource="{x:Bind ViewModel.SelectedNode.Properties, Mode=OneWay}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="vm:PropertyItem">
                            <Grid Margin="0,0,0,12" ColumnSpacing="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="200"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="{x:Bind Name}" VerticalAlignment="Center" 
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>

                                <TextBox Grid.Column="1" Text="{x:Bind ValueAsString, Mode=TwoWay, UpdateSourceTrigger=LostFocus}" 
                                         IsReadOnly="{x:Bind IsReadOnly, Mode=OneWay}"/>
                            </Grid>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>